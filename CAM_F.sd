sequenceDiagram
    participant WO as Workload Owner
    participant W as Workload
    participant V as Verifier
    participant KS as KeyStore
    participant CA as Credential Authority
    note over WO, CA: Credential Provisioning Phase
    WO->>WO: Create Workload Identity<br/>and Associated Claims
    WO->>WO: Create Credential Key Release Policy<br/>based on Workload Reference Values
    WO->>KS: Create Credential Key<br/>and Set Key Release Policy
    KS->>KS: Generate and Store<br/>Credential Key and Policy
    KS->>WO: Public Portion of Credential Key
    WO->>KS: Create Credential Request
    KS->>KS: Generate Credential Request<br/>and Sign with Private Credential Key
    KS->>WO: Credential Request
    WO->>CA: Credential Request<br/>plus Workload Identity<br/>and Associated Claims
    CA->>CA: Generate and Sign Credential
    CA->>WO: Credential
    WO->>W: Provide Workload<br/>with Credential
    note over WO, CA: Credential Acquisition Phase
    W->>W: Generate Asymmetric<br/>Encryption Key
    W->>W: Generate Evidence (Quote)<br/>including Encryption Key
    W->>V: Request Attestation Results<br/>passing Quote as Evidence
    V->>V: Compute Attestation Results
    V->>W: Attestation Results<br/>including Encryption Key
    W->>KS: Attestation Results<br/>including Encryption Key
    KS->>KS: Validate Attestation Results<br/>against Key Release Policy
    KS->>KS: Encrypt Credential Key<br/>to Encryption Key
    KS->>W: Encrypted Credential Key
    W->>W: Decrypt Credential Key
